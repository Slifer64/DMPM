function Ja = lwr4_jacob(q)
    s=[0,0,0,0,0,0,0]';  
    c=s;
    for i=1:7
        c(i) = cos(q(i));
        s(i) = sin(q(i));
    end
    Ja(1,1)   =  0.4*s(1)*s(2)+0.39*c(4)*s(1)*s(2)-0.39*c(1)*s(3)*s(4)-0.39*c(2)*c(3)*s(1)*s(4)+0.088*c(4)*c(6)*s(1)*s(2)-0.088*c(1)*c(6)*s(3)*s(4)+0.088*c(1)*c(3)*s(5)*s(6)-0.088*c(2)*s(1)*s(3)*s(5)*s(6)+0.088*c(5)*s(1)*s(2)*s(4)*s(6)-0.088*c(2)*c(3)*c(6)*s(1)*s(4)+0.088*c(1)*c(4)*c(5)*s(3)*s(6)+0.088*c(2)*c(3)*c(4)*c(5)*s(1)*s(6);
    Ja(1,2)   = -c(1)*(0.4*c(2)+0.39*c(2)*c(4)+0.088*c(2)*c(4)*c(6)+0.39*c(3)*s(2)*s(4)+0.088*c(3)*c(6)*s(2)*s(4)+0.088*c(2)*c(5)*s(4)*s(6)+0.088*s(2)*s(3)*s(5)*s(6)-0.088*c(3)*c(4)*c(5)*s(2)*s(6));
    Ja(1,3)   =  0.088*c(1)*c(2)*c(3)*s(5)*s(6)-0.39*c(3)*s(1)*s(2)^2*s(4)-0.39*c(1)*c(2)*s(3)*s(4)-0.088*c(2)^2*c(3)*c(6)*s(1)*s(4)-0.088*c(3)*c(6)*s(1)*s(2)^2*s(4)-0.088*c(2)^2*s(1)*s(3)*s(5)*s(6)-0.088*s(1)*s(2)^2*s(3)*s(5)*s(6)-0.088*c(1)*c(2)*c(6)*s(3)*s(4)-0.39*c(2)^2*c(3)*s(1)*s(4)+0.088*c(1)*c(2)*c(4)*c(5)*s(3)*s(6)+0.088*c(2)^2*c(3)*c(4)*c(5)*s(1)*s(6)+0.088*c(3)*c(4)*c(5)*s(1)*s(2)^2*s(6);
    Ja(1,4)   =  0.39*c(1)*c(3)^2*s(2)*s(4)-0.39*c(2)^2*c(4)*s(1)*s(3)+0.39*c(1)*s(2)*s(3)^2*s(4)-0.39*c(4)*s(1)*s(2)^2*s(3)+0.39*c(1)*c(2)*c(3)*c(4)+0.088*c(1)*c(3)^2*c(6)*s(2)*s(4)-0.088*c(2)^2*c(4)*c(6)*s(1)*s(3)+0.088*c(1)*c(6)*s(2)*s(3)^2*s(4)-0.088*c(4)*c(6)*s(1)*s(2)^2*s(3)+0.088*c(1)*c(2)*c(3)*c(4)*c(6)-0.088*c(5)*s(1)*s(2)^2*s(3)*s(4)*s(6)+0.088*c(1)*c(2)*c(3)*c(5)*s(4)*s(6)-0.088*c(1)*c(3)^2*c(4)*c(5)*s(2)*s(6)-0.088*c(1)*c(4)*c(5)*s(2)*s(3)^2*s(6)-0.088*c(2)^2*c(5)*s(1)*s(3)*s(4)*s(6);
    Ja(1,5)   =  s(6)*(0.088*c(5)*s(1)*c(2)^2*c(3)*c(4)^2+0.088*c(5)*s(1)*c(2)^2*c(3)*s(4)^2-0.088*s(1)*s(5)*c(2)^2*c(4)*s(3)+0.088*c(1)*s(5)*c(2)*c(3)*c(4)+0.088*c(1)*c(5)*c(2)*c(4)^2*s(3)+0.088*c(1)*c(5)*c(2)*s(3)*s(4)^2+0.088*c(1)*s(5)*c(3)^2*s(2)*s(4)+0.088*c(5)*s(1)*c(3)*c(4)^2*s(2)^2+0.088*c(5)*s(1)*c(3)*s(2)^2*s(4)^2-0.088*s(1)*s(5)*c(4)*s(2)^2*s(3)+0.088*c(1)*s(5)*s(2)*s(3)^2*s(4));
    Ja(1,6)   =  0.088*c(6)*s(1)*c(2)^2*c(3)*c(4)^2*s(5)+0.088*c(6)*s(1)*c(2)^2*c(3)*s(4)^2*s(5)+0.088*c(6)*s(1)*c(2)^2*c(4)*c(5)*s(3)+0.088*s(1)*s(6)*c(2)^2*c(5)^2*s(3)*s(4)+0.088*s(1)*s(6)*c(2)^2*s(3)*s(4)*s(5)^2-0.088*c(1)*c(6)*c(2)*c(3)*c(4)*c(5)-0.088*c(1)*s(6)*c(2)*c(3)*c(5)^2*s(4)-0.088*c(1)*s(6)*c(2)*c(3)*s(4)*s(5)^2+0.088*c(1)*c(6)*c(2)*c(4)^2*s(3)*s(5)+0.088*c(1)*c(6)*c(2)*s(3)*s(4)^2*s(5)+0.088*c(1)*s(6)*c(3)^2*c(4)*c(5)^2*s(2)+0.088*c(1)*s(6)*c(3)^2*c(4)*s(2)*s(5)^2-0.088*c(1)*c(6)*c(3)^2*c(5)*s(2)*s(4)+0.088*c(6)*s(1)*c(3)*c(4)^2*s(2)^2*s(5)+0.088*c(6)*s(1)*c(3)*s(2)^2*s(4)^2*s(5)+0.088*c(1)*s(6)*c(4)*c(5)^2*s(2)*s(3)^2+0.088*c(6)*s(1)*c(4)*c(5)*s(2)^2*s(3)+0.088*c(1)*s(6)*c(4)*s(2)*s(3)^2*s(5)^2+0.088*s(1)*s(6)*c(5)^2*s(2)^2*s(3)*s(4)-0.088*c(1)*c(6)*c(5)*s(2)*s(3)^2*s(4)+0.088*s(1)*s(6)*s(2)^2*s(3)*s(4)*s(5)^2;
    Ja(1,7)   =  0;
    Ja(2,1)   =  0.39*c(1)*c(2)*c(3)*s(4)-0.39*c(1)*c(4)*s(2)-0.39*s(1)*s(3)*s(4)-0.4*c(1)*s(2)-0.088*c(1)*c(4)*c(6)*s(2)-0.088*c(6)*s(1)*s(3)*s(4)+0.088*c(3)*s(1)*s(5)*s(6)+0.088*c(1)*c(2)*s(3)*s(5)*s(6)-0.088*c(1)*c(5)*s(2)*s(4)*s(6)+0.088*c(4)*c(5)*s(1)*s(3)*s(6)+0.088*c(1)*c(2)*c(3)*c(6)*s(4)-0.088*c(1)*c(2)*c(3)*c(4)*c(5)*s(6);
    Ja(2,2)   = -s(1)*(0.4*c(2)+0.39*c(2)*c(4)+0.088*c(2)*c(4)*c(6)+0.39*c(3)*s(2)*s(4)+0.088*c(3)*c(6)*s(2)*s(4)+0.088*c(2)*c(5)*s(4)*s(6)+0.088*s(2)*s(3)*s(5)*s(6)-0.088*c(3)*c(4)*c(5)*s(2)*s(6));
    Ja(2,3)   =  0.39*c(1)*c(2)^2*c(3)*s(4)+0.39*c(1)*c(3)*s(2)^2*s(4)-0.39*c(2)*s(1)*s(3)*s(4)-0.088*c(2)*c(6)*s(1)*s(3)*s(4)+0.088*c(2)*c(3)*s(1)*s(5)*s(6)+0.088*c(1)*c(2)^2*c(3)*c(6)*s(4)+0.088*c(1)*c(3)*c(6)*s(2)^2*s(4)+0.088*c(1)*c(2)^2*s(3)*s(5)*s(6)+0.088*c(1)*s(2)^2*s(3)*s(5)*s(6)+0.088*c(2)*c(4)*c(5)*s(1)*s(3)*s(6)-0.088*c(1)*c(2)^2*c(3)*c(4)*c(5)*s(6)-0.088*c(1)*c(3)*c(4)*c(5)*s(2)^2*s(6);
    Ja(2,4)   =  0.39*c(1)*c(2)^2*c(4)*s(3)+0.39*c(1)*c(4)*s(2)^2*s(3)+0.39*c(3)^2*s(1)*s(2)*s(4)+0.39*s(1)*s(2)*s(3)^2*s(4)+0.39*c(2)*c(3)*c(4)*s(1)+0.088*c(1)*c(2)^2*c(4)*c(6)*s(3)+0.088*c(1)*c(4)*c(6)*s(2)^2*s(3)+0.088*c(3)^2*c(6)*s(1)*s(2)*s(4)+0.088*c(6)*s(1)*s(2)*s(3)^2*s(4)+0.088*c(2)*c(3)*c(4)*c(6)*s(1)+0.088*c(2)*c(3)*c(5)*s(1)*s(4)*s(6)+0.088*c(1)*c(2)^2*c(5)*s(3)*s(4)*s(6)-0.088*c(3)^2*c(4)*c(5)*s(1)*s(2)*s(6)+0.088*c(1)*c(5)*s(2)^2*s(3)*s(4)*s(6)-0.088*c(4)*c(5)*s(1)*s(2)*s(3)^2*s(6);
    Ja(2,5)   =  s(6)*(0.088*c(1)*s(5)*c(2)^2*c(4)*s(3)-0.088*c(1)*c(5)*c(2)^2*c(3)*s(4)^2-0.088*c(1)*c(5)*c(2)^2*c(3)*c(4)^2+0.088*s(1)*s(5)*c(2)*c(3)*c(4)+0.088*c(5)*s(1)*c(2)*c(4)^2*s(3)+0.088*c(5)*s(1)*c(2)*s(3)*s(4)^2+0.088*s(1)*s(5)*c(3)^2*s(2)*s(4)-0.088*c(1)*c(5)*c(3)*c(4)^2*s(2)^2-0.088*c(1)*c(5)*c(3)*s(2)^2*s(4)^2+0.088*c(1)*s(5)*c(4)*s(2)^2*s(3)+0.088*s(1)*s(5)*s(2)*s(3)^2*s(4));
    Ja(2,6)   =  0.088*c(6)*s(1)*c(2)*c(4)^2*s(3)*s(5)-0.088*c(1)*c(6)*c(2)^2*c(3)*s(4)^2*s(5)-0.088*c(1)*c(6)*c(2)^2*c(4)*c(5)*s(3)-0.088*c(1)*s(6)*c(2)^2*c(5)^2*s(3)*s(4)-0.088*c(1)*s(6)*c(2)^2*s(3)*s(4)*s(5)^2-0.088*c(6)*s(1)*c(2)*c(3)*c(4)*c(5)-0.088*s(1)*s(6)*c(2)*c(3)*c(5)^2*s(4)-0.088*s(1)*s(6)*c(2)*c(3)*s(4)*s(5)^2-0.088*c(1)*c(6)*c(2)^2*c(3)*c(4)^2*s(5)+0.088*c(6)*s(1)*c(2)*s(3)*s(4)^2*s(5)+0.088*s(1)*s(6)*c(3)^2*c(4)*c(5)^2*s(2)+0.088*s(1)*s(6)*c(3)^2*c(4)*s(2)*s(5)^2-0.088*c(6)*s(1)*c(3)^2*c(5)*s(2)*s(4)-0.088*c(1)*c(6)*c(3)*c(4)^2*s(2)^2*s(5)-0.088*c(1)*c(6)*c(3)*s(2)^2*s(4)^2*s(5)+0.088*s(1)*s(6)*c(4)*c(5)^2*s(2)*s(3)^2-0.088*c(1)*c(6)*c(4)*c(5)*s(2)^2*s(3)+0.088*s(1)*s(6)*c(4)*s(2)*s(3)^2*s(5)^2-0.088*c(1)*s(6)*c(5)^2*s(2)^2*s(3)*s(4)-0.088*c(6)*s(1)*c(5)*s(2)*s(3)^2*s(4)-0.088*c(1)*s(6)*s(2)^2*s(3)*s(4)*s(5)^2;
    Ja(2,7)   =  0; 
    Ja(3,1)   =  0;
    Ja(3,2)   = -(c(1)^2+s(1)^2)*(0.4*s(2)+0.39*c(4)*s(2)-0.39*c(2)*c(3)*s(4)+0.088*c(4)*c(6)*s(2)-0.088*c(2)*c(3)*c(6)*s(4)-0.088*c(2)*s(3)*s(5)*s(6)+0.088*c(5)*s(2)*s(4)*s(6)+0.088*c(2)*c(3)*c(4)*c(5)*s(6));
    Ja(3,3)   = -s(2)*(c(1)^2+s(1)^2)*(0.39*s(3)*s(4)+0.088*c(6)*s(3)*s(4)-0.088*c(3)*s(5)*s(6)-0.088*c(4)*c(5)*s(3)*s(6));
    Ja(3,4)   =  (c(1)^2+s(1)^2)*(0.39*c(3)*c(4)*s(2)-0.39*c(2)*c(3)^2*s(4)-0.39*c(2)*s(3)^2*s(4)-0.088*c(2)*c(3)^2*c(6)*s(4)-0.088*c(2)*c(6)*s(3)^2*s(4)+0.088*c(3)*c(4)*c(6)*s(2)+0.088*c(3)*c(5)*s(2)*s(4)*s(6)+0.088*c(2)*c(3)^2*c(4)*c(5)*s(6)+0.088*c(2)*c(4)*c(5)*s(3)^2*s(6));
    Ja(3,5)   =  s(6)*(c(1)^2+s(1)^2)*(0.088*s(2)*s(5)*c(3)*c(4)-0.088*c(2)*s(5)*c(3)^2*s(4)+0.088*c(5)*s(2)*c(4)^2*s(3)-0.088*c(2)*s(5)*s(3)^2*s(4)+0.088*c(5)*s(2)*s(3)*s(4)^2);
    Ja(3,6)   = -(c(1)^2+s(1)^2)*(0.088*c(2)*s(6)*c(3)^2*c(4)*c(5)^2+0.088*c(2)*s(6)*c(3)^2*c(4)*s(5)^2-0.088*c(2)*c(6)*c(3)^2*c(5)*s(4)+0.088*c(6)*s(2)*c(3)*c(4)*c(5)+0.088*s(2)*s(6)*c(3)*c(5)^2*s(4)+0.088*s(2)*s(6)*c(3)*s(4)*s(5)^2-0.088*c(6)*s(2)*c(4)^2*s(3)*s(5)+0.088*c(2)*s(6)*c(4)*c(5)^2*s(3)^2+0.088*c(2)*s(6)*c(4)*s(3)^2*s(5)^2-0.088*c(2)*c(6)*c(5)*s(3)^2*s(4)-0.088*c(6)*s(2)*s(3)*s(4)^2*s(5)); 
    Ja(3,7)   =  0;
    Ja(4,1)   =  0;
    Ja(4,2)   =  s(1);
    Ja(4,3)   = -c(1)*s(2);
    Ja(4,4)   = -c(3)*s(1)-c(1)*c(2)*s(3);
    Ja(4,5)   =  c(1)*c(2)*c(3)*s(4)-s(1)*s(3)*s(4)-c(1)*c(4)*s(2);
    Ja(4,6)   =  c(3)*c(5)*s(1)+c(1)*c(2)*c(5)*s(3)+c(1)*s(2)*s(4)*s(5)-c(4)*s(1)*s(3)*s(5)+c(1)*c(2)*c(3)*c(4)*s(5);
    Ja(4,7)   =  c(3)*s(1)*s(5)*s(6)-c(6)*s(1)*s(3)*s(4)-c(1)*c(4)*c(6)*s(2)+c(1)*c(2)*s(3)*s(5)*s(6)-c(1)*c(5)*s(2)*s(4)*s(6)+c(4)*c(5)*s(1)*s(3)*s(6)+c(1)*c(2)*c(3)*c(6)*s(4)-c(1)*c(2)*c(3)*c(4)*c(5)*s(6);
    Ja(5,1)   =  0;
    Ja(5,2)   = -c(1);
    Ja(5,3)   = -s(1)*s(2);
    Ja(5,4)   =  c(1)*c(3)-c(2)*s(1)*s(3);
    Ja(5,5)   =  c(1)*s(3)*s(4)-c(4)*s(1)*s(2)+c(2)*c(3)*s(1)*s(4);
    Ja(5,6)   =  c(2)*c(5)*s(1)*s(3)-c(1)*c(3)*c(5)+c(1)*c(4)*s(3)*s(5)+s(1)*s(2)*s(4)*s(5)+c(2)*c(3)*c(4)*s(1)*s(5);
    Ja(5,7)   =  c(1)*c(6)*s(3)*s(4)-c(4)*c(6)*s(1)*s(2)-c(1)*c(3)*s(5)*s(6)+c(2)*s(1)*s(3)*s(5)*s(6)-c(5)*s(1)*s(2)*s(4)*s(6)+c(2)*c(3)*c(6)*s(1)*s(4)-c(1)*c(4)*c(5)*s(3)*s(6)-c(2)*c(3)*c(4)*c(5)*s(1)*s(6);
    Ja(6,1)   =  1;
    Ja(6,2)   =  0;
    Ja(6,3)   =  c(2);
    Ja(6,4)   = -s(2)*s(3);
    Ja(6,5)   =  c(2)*c(4)+c(3)*s(2)*s(4);
    Ja(6,6)   =  c(5)*s(2)*s(3)-c(2)*s(4)*s(5)+c(3)*c(4)*s(2)*s(5);
    Ja(6,7)   =  c(2)*c(4)*c(6)+c(3)*c(6)*s(2)*s(4)+c(2)*c(5)*s(4)*s(6)+s(2)*s(3)*s(5)*s(6)-c(3)*c(4)*c(5)*s(2)*s(6);
end

